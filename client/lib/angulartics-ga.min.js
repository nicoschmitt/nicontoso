!function(e,n,t){"use strict";n.module("angulartics.google.analytics",["angulartics"]).config(["$analyticsProvider",function(t){function i(){var n=e.GoogleAnalyticsObject;return n&&e[n]}function a(){return!n.isUndefined(e._gaq)}function r(e){var n,t={};for(n in e)n.indexOf("dimension")&&n.indexOf("metric")||(t[n]=e[n]);return t}t.settings.pageTracking.trackRelativePath=!0,t.settings.ga={additionalAccountNames:void 0,additionalAccountHitTypes:{pageview:!0,event:!0,exception:!1,ecommerce:!1,userTiming:!1,setUserProperties:!1,userId:!1},disableEventTracking:null,disablePageTracking:null,enhancedEcommerce:!1,transport:null,userId:null},t.registerPageTrack(function(e,i){i=i||{},t.settings.ga.disablePageTracking||c("pageview","send",n.extend({},i,{hitType:"pageview",page:e}))}),t.registerEventTrack(function(i,a){if(!t.settings.ga.disableEventTracking&&(i||i+""=="0")){if(a=a||{},a.category=a.category||"Event",a.value){var r=parseInt(a.value,10);a.value=isNaN(r)?0:r}n.isFunction(a.hitCallback)||(a.hitCallback=null),a.nonInteraction=a.nonInteraction||a.noninteraction,c("event","send",n.extend({},a,{hitType:"event",eventCategory:a.category,eventAction:i,eventLabel:a.label,eventValue:a.value,nonInteraction:a.nonInteraction,page:a.page||e.location.hash.substring(1)||e.location.pathname,hitCallback:a.hitCallback}))}}),t.registerExceptionTrack(function(n,t){c("exception","send",{hitType:"event",eventCategory:"Exceptions",eventAction:n.toString(),eventLabel:n.stack,nonInteraction:!0,page:e.location.hash.substring(1)||e.location.pathname,isException:!0})}),t.registerSetUsername(function(e){t.settings.ga.userId=e}),t.registerSetUserProperties(function(e){e&&c("setUserProperties","set",r(e))}),t.registerUserTimings(function(t){if(!n.isObject(t)||n.isArray(t))return console.log("Required argument properties is missing or not an object");n.forEach(["timingCategory","timingVar","timingValue"],function(e){if(n.isUndefined(t[e]))return console.log("Argument properties missing required property "+e)}),c("userTiming","send",{hitType:"timing",timingCategory:t.timingCategory,timingVar:t.timingVar,timingValue:t.timingValue,timingLabel:t.timingLabel,optSampleRate:t.optSampleRate,page:t.page||e.location.hash.substring(1)||e.location.pathname})}),t.registerTransactionTrack(function(e){var t,i;if(c("ecommerce","require","ecommerce"),c("ecommerce","ecommerce:addTransaction",e),e.products)for(i=0;i<e.products.length;i++)(t=e.products[i]).sku=t.id,t.id=e.id,c("ecommerce","ecommerce:addItem",e.products[i]);e.currencyCode&&c("ecommerce","_set",e.currencyCode),c("ecommerce","ecommerce:send",n.copy(e))});var c=function(){function r(e,i,a){var r,o=t.settings.ga.userId;if("require"===e&&"ecommerce"===i)return r=i,t.settings.ga.enhancedEcommerce&&(r="ec"),c([e,r],a);if(o&&n.isObject(i)&&(i.userId=o),t.settings.ga.transport&&(i.transport=t.settings.ga.transport),e.indexOf("ecommerce:")>-1&&t.settings.ga.enhancedEcommerce)switch(e){case"ecommerce:addTransaction":e=["ec:setAction","purchase"];break;case"ecommerce:addItem":e="ec:addProduct",i.id=i.sku;break;case"ecommerce:send":e="send",i.hitType="event",i.eventCategory="Angulartics Enhanced Ecommerce",i.eventAction="Purchase",i.nonInteraction=!0}c(e instanceof Array?e.concat(i):[e,i],a)}function c(i,a){var r,c=t.settings.ga.userId,o=e.GoogleAnalyticsObject;e[o].apply(this,i),a&&(r=n.copy(i),c&&!t.settings.ga.additionalAccountHitTypes.userId&&r[2]&&"object"==typeof r[2]&&delete r[2].userId,n.forEach(t.settings.ga.additionalAccountNames,function(n){r[0]=n+"."+r[0],e[o].apply(this,r)}))}function o(i,a,r){if("set"===i)return console.log('Classic Analytics does not support the "set" command or Custom Dimensions. Command ignored.');var c;if("send"===i)switch(a.hitType){case"pageview":c=["_trackPageview",a.page];break;case"event":c=["_trackEvent",a.category,a.action,a.label,a.value,a.nonInteraction];break;case"timing":c=["_trackTiming",a.timingCategory,a.timingVar,a.timingValue,a.timingLabel,a.optSampleRate]}if("ecommerce:addTransaction"===i&&(c=["_addTrans",a.id,a.affiliation,a.revenue,a.tax,a.shipping,a.billingCity,a.billingRegion,a.billingCountry]),"ecommerce:addItem"===i&&(c=["_addItem",a.id,a.sku,a.name,a.category,a.price,a.quantity]),"_set"===i&&(c=["_set","currencyCode",a]),"ecommerce:send"===i&&(c=["_trackTrans"]),!c)return console.log("Unable to find command "+i+" or fieldsObj missing required properties. Command ignored.");e._gaq.push(c),r&&n.forEach(t.settings.ga.additionalAccountNames,function(n){var t=[].slice.call(c);t[0]=n+"."+t[0],e._gaq.push(t)})}var s;return a()&&(s=o),i()&&(s=r),s?function(e,n,i){var a=t.settings.ga.additionalAccountHitTypes[e];s(n,i,a)}:n.noop}()}])}(window,window.angular);