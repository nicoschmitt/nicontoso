!function(e,n,t){"use strict";n.module("angulartics.google.analytics",["angulartics"]).config(["$analyticsProvider",function(i){function a(){var n=e.GoogleAnalyticsObject;return n&&e[n]}function r(){return!n.isUndefined(e._gaq)}function c(e){var n,t={};for(n in e)n.indexOf("dimension")&&n.indexOf("metric")||(t[n]=e[n]);return t}i.settings.pageTracking.trackRelativePath=!0,i.settings.ga={additionalAccountNames:t,additionalAccountHitTypes:{pageview:!0,event:!0,exception:!1,ecommerce:!1,userTiming:!1,setUserProperties:!1,userId:!1},disableEventTracking:null,disablePageTracking:null,userId:null,enhancedEcommerce:!1},i.registerPageTrack(function(e,t){t=t||{},i.settings.ga.disablePageTracking||o("pageview","send",n.extend(c(t),{hitType:"pageview",page:e}))}),i.registerEventTrack(function(t,a){if(!i.settings.ga.disableEventTracking){if(!t&&t+""!="0")return console.log("Missing required argument action");if(a=a||{},a.category=a.category||"Event",a.value){var r=parseInt(a.value,10);a.value=isNaN(r)?0:r}n.isFunction(a.hitCallback)||(a.hitCallback=null),a.nonInteraction=a.nonInteraction||a.noninteraction,o("event","send",n.extend(c(a),{hitType:"event",eventCategory:a.category,eventAction:t,eventLabel:a.label,eventValue:a.value,nonInteraction:a.nonInteraction,page:a.page||e.location.hash.substring(1)||e.location.pathname,hitCallback:a.hitCallback}))}}),i.registerExceptionTrack(function(n,t){o("exception","send",{hitType:"event",eventCategory:"Exceptions",eventAction:n.toString(),eventLabel:n.stack,nonInteraction:!0,page:e.location.hash.substring(1)||e.location.pathname,isException:!0})}),i.registerSetUsername(function(e){i.settings.ga.userId=e}),i.registerSetUserProperties(function(e){e&&o("setUserProperties","set",c(e))}),i.registerUserTimings(function(t){return!n.isObject(t)||n.isArray(t)?console.log("Required argument properties is missing or not an object"):(n.forEach(["timingCategory","timingVar","timingValue"],function(e){if(n.isUndefined(t[e]))return console.log("Argument properties missing required property "+e)}),void o("userTiming","send",{hitType:"timing",timingCategory:t.timingCategory,timingVar:t.timingVar,timingValue:t.timingValue,timingLabel:t.timingLabel,optSampleRate:t.optSampleRate,page:t.page||e.location.hash.substring(1)||e.location.pathname}))}),i.registerTransactionTrack(function(e){var n,t;if(o("ecommerce","require","ecommerce"),o("ecommerce","ecommerce:addTransaction",e),e.products)for(t=0;t<e.products.length;t++)n=e.products[t],n.sku=n.id,n.id=e.id,o("ecommerce","ecommerce:addItem",e.products[t]);e.currencyCode&&o("ecommerce","_set",e.currencyCode),o("ecommerce","ecommerce:send",c(e))});var o=function(){function t(t,a,r){var c,o=e.GoogleAnalyticsObject,s=i.settings.ga.userId;if(s&&n.isObject(a)&&(a.userId=s),t.indexOf("ecommerce:")>-1&&i.settings.ga.enhancedEcommerce)switch(t){case"ecommerce:addTransaction":t=["ec:setAction","purchase"];break;case"ecommerce:addItem":t="ec:addProduct",a.id=a.sku;break;case"ecommerce:send":t="send",a.hitType="event",a.eventCategory="Angulartics Enhanced Ecommerce",a.eventAction="Purchase",a.nonInteraction=!0}"require"===t&&"ecommerce"===a&&i.settings.ga.enhancedEcommerce&&(a="ec"),c=t instanceof Array?t.concat(a):[t,a],e[o].apply(this,c),r&&(s&&!i.settings.ga.additionalAccountHitTypes.userId&&delete a.userId,n.forEach(i.settings.ga.additionalAccountNames,function(n){var t=[].slice.call(c);t[0]=n+"."+t[0],e[o].apply(this,t)}))}function c(t,a,r){if("set"===t)return console.log('Classic Analytics does not support the "set" command or Custom Dimensions. Command ignored.');var c;if("send"===t)switch(a.hitType){case"pageview":c=["_trackPageview",a.page];break;case"event":c=["_trackEvent",a.category,a.action,a.label,a.value,a.nonInteraction];break;case"timing":c=["_trackTiming",a.timingCategory,a.timingVar,a.timingValue,a.timingLabel,a.optSampleRate]}return"ecommerce:addTransaction"===t&&(c=["_addTrans",a.id,a.affiliation,a.revenue,a.tax,a.shipping,a.billingCity,a.billingRegion,a.billingCountry]),"ecommerce:addItem"===t&&(c=["_addItem",a.id,a.sku,a.name,a.category,a.price,a.quantity]),"_set"===t&&(c=["_set","currencyCode",a]),"ecommerce:send"===t&&(c=["_trackTrans"]),c?(e._gaq.push(c),void(r&&n.forEach(i.settings.ga.additionalAccountNames,function(n){var t=[].slice.call(c);t[0]=n+"."+t[0],e._gaq.push(t)}))):console.log("Unable to find command "+t+" or fieldsObj missing required properties. Command ignored.")}var o;return r()&&(o=c),a()&&(o=t),o?function(e,n,t){var a=i.settings.ga.additionalAccountHitTypes[e];o(n,t,a)}:(console.log("Error: neither Classic nor Universal Analytics detected at bootstrap. Angulartics-GA will ignore all commands!"),n.noop)}()}])}(window,window.angular);